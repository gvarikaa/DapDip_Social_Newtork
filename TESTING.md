# მიგრაციის ტესტირების ინსტრუქცია

ეს დოკუმენტი შეიცავს მითითებებს, თუ როგორ უნდა გატესტოთ მიგრაციის პროცესი Clerk-დან Supabase-ზე და ImageKit-დან Bunny.net-ზე.

## გარემოს მომზადება

მიგრაციის ტესტირებისთვის აუცილებელია გარემოს ცვლადების სწორად მითითება. შექმენით ან განაახლეთ თქვენი `.env.local` ფაილი შემდეგი ცვლადებით:

```
# Supabase კონფიგურაცია
NEXT_PUBLIC_SUPABASE_URL=https://your-project-url.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-public-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Bunny.net კონფიგურაცია
NEXT_PUBLIC_BUNNY_PULLZONE_URL=https://your-pullzone.b-cdn.net
BUNNY_API_KEY=your-api-key
BUNNY_STORAGE_ZONE_NAME=your-storage-zone

# დეველოპერის რეჟიმი - ლოკალურად ფაილების შესანახად
USE_LOCAL_FILES=true
```

გთხოვთ, გაითვალისწინოთ:
- დეველოპერის რეჟიმში შეგიძლიათ ჩართოთ `USE_LOCAL_FILES=true`, რაც საშუალებას მოგცემთ ფაილები შეინახოთ ლოკალურად, Bunny.net-ის გარეშე
- თუ გაქვთ Supabase-ის კონფიგურაცია, შეგიძლიათ გამოიყენოთ ის, წინააღმდეგ შემთხვევაში დროებითი ავთენტიფიკაცია გამოიყენება

## აპლიკაციის გაშვება

აპლიკაციის გასაშვებად, გამოიყენეთ შემდეგი ბრძანებები:

```bash
# პაკეტების ინსტალაცია (თუ საჭიროა)
npm install

# განვითარების რეჟიმში გაშვება
npm run dev
```

აპლიკაცია ჩაიტვირთება ლოკალურად `http://localhost:3000` მისამართზე.

## დებაგის გვერდები

აპლიკაციაში ხელმისაწვდომია სპეციალური დებაგის გვერდები მიგრაციის პროცესის შესამოწმებლად:

1. **ავთენტიფიკაციის დებაგი**: `http://localhost:3000/debug/auth-migration`
   - აჩვენებს კლიენტისა და სერვერის ავთენტიფიკაციის სტატუსს
   - აჩვენებს მიგრაციის პროგრესს

2. **API სტატუსის შემოწმება**: `http://localhost:3000/api/debug/auth-status`
   - API ენდპოინტი, რომელიც აბრუნებს მიმდინარე ავთენტიფიკაციის სტატუსს JSON ფორმატში

## ძირითადი ფუნქციების ტესტირება

### 1. ავთორიზაცია:
- სცადეთ ავტორიზაცია `/auth/signin` გვერდზე
- სცადეთ რეგისტრაცია `/auth/signup` გვერდზე
- შეამოწმეთ დაცული მარშრუტები (`/`, `/profile`, ა.შ.)

### 2. აპლიკაციის ფუნქციები:
- სცადეთ პოსტის შექმნა
- შეამოწმეთ პოსტის ნახვა
- სცადეთ კომენტარის დამატება
- შეამოწმეთ მედია ფაილების ჩატვირთვა და ჩვენება

## API მარშრუტების ტესტირება

API მარშრუტების შესამოწმებლად, შეგიძლიათ გამოიყენოთ ბრაუზერის კონსოლი ან ინსტრუმენტები როგორიცაა Postman:

```javascript
// ავთენტიფიკაციის შემოწმება
fetch('/api/debug/auth-status').then(res => res.json()).then(console.log);

// პოსტების მიღება
fetch('/api/posts?cursor=1').then(res => res.json()).then(console.log);

// მომხმარებლის მონაცემების მიღება
fetch('/api/users/user-id-here').then(res => res.json()).then(console.log);
```

## პრობლემების გამოვლენა

მიგრაციის პროცესში შესაძლოა წააწყდეთ შემდეგ პრობლემებს:

1. **ავთორიზაციის შეცდომები**: დარწმუნდით, რომ Supabase-ის კონფიგურაცია სწორია
2. **მედიის ჩატვირთვის პრობლემები**: შეამოწმეთ Bunny.net-ის კონფიგურაცია
3. **404 შეცდომები API გამოძახებებზე**: შეამოწმეთ, რომ ყველა მარშრუტი არის სწორად განახლებული
4. **კონსოლის შეცდომები**: კონსოლში ნახეთ რა იმპორტები ან ფუნქციები აკლია

### პრობლემების აღრიცხვა

თუ აღმოაჩენთ პრობლემას, მნიშვნელოვანია მისი დოკუმენტირება:

1. შეაგროვეთ კონკრეტული შეცდომის შეტყობინება
2. აღწერეთ ნაბიჯები შეცდომის გამოსაწვევად
3. მიუთითეთ ფაილი და ხაზი, სადაც პრობლემაა
4. დაამატეთ შესაძლო გადაწყვეტის გზები

## ცვლილებების უკან დაბრუნება

თუ აღმოაჩენთ სერიოზულ პრობლემას, რომელიც ბლოკავს განვითარებას, შეგიძლიათ დააბრუნოთ ცვლილებები:

```bash
# დააბრუნეთ ყველა ცვლილება მიგრაციის დაწყებამდე
git reset --hard <commit-before-migration>

# ან დააბრუნეთ კონკრეტული ფაილი
git checkout <commit-before-migration> -- path/to/file
```

## მიგრაციის დასრულების შემოწმება

მიგრაცია წარმატებით დასრულდა, თუ:

1. აპლიკაცია იშვება შეცდომების გარეშე
2. ავთენტიფიკაცია მუშაობს როგორც კლიენტის, ისე სერვერის მხარეს
3. მედია ფაილები ჩატვირთვა და ჩვენება ხდება კორექტულად
4. API მარშრუტები პასუხობენ მოთხოვნებს
5. არცერთი Clerk ან ImageKit იმპორტი აღარ ფიქსირდება კოდში